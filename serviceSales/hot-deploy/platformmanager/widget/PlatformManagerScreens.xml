<?xml version="1.0" encoding="UTF-8"?>
<screens xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://ofbiz.apache.org/Widget-Screen" xsi:schemaLocation="http://ofbiz.apache.org/Widget-Screen http://ofbiz.apache.org/dtds/widget-screen.xsd">

    <screen name="main">
        <section>
            <actions>
                <set field="headerItem" value="main"/><!-- this highlights the selected menu-item with name "main" -->
            </actions>
            <widgets>
                <decorator-screen name="PlatformManagerCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="LoadOSSResourceHtml">
        <section>
            <actions>
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://platformmanager/webapp/platformmanager/template/image/OSSImageList.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>


    <screen name="ExportShareCpsToExcel">
        <section>
            <actions>
            </actions>
            <widgets>
                <decorator-screen name="main-decorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <!--<include-menu name="EcBackofficeTabBar" location="component://ecbackoffice/widget/EcBackofficeMenus.xml"/>-->
                        <screenlet title="导出分享报表Excel">
                            <include-form name="ExportShareCpsToExcel" location="component://platformmanager/widget/PlatformManagerForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <!-- 产品导入 -->
    <screen name="ProductUploadImport">
        <section>
            <actions>
            </actions>
            <widgets>
                <decorator-screen name="main-decorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <!--<include-menu name="EcBackofficeTabBar" location="component://ecbackoffice/widget/EcBackofficeMenus.xml"/>-->
                        <screenlet title="素然产品导入">
                            <include-form name="ProductUploadImportForm" location="component://platformmanager/widget/PlatformManagerForms.xml"/>
                        </screenlet>
                        <screenlet title="康橙产品导入">
                            <include-form name="KangChengProductUploadImportForm" location="component://platformmanager/widget/PlatformManagerForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <!-- 快速运送整个订单,这种做法不对... -->
    <screen name="QuickShipOrder">
        <section>
            <actions>
            </actions>
            <widgets>
                <decorator-screen name="main-decorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <!--<include-menu name="EcBackofficeTabBar" location="component://ecbackoffice/widget/EcBackofficeMenus.xml"/>-->
                        <screenlet title="快速装运">
                            <include-form name="QuickShipOrderForm" location="component://platformmanager/widget/PlatformManagerForms.xml"/>
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>


    <!-- 产品图片导入 -->
    <screen name="ProductImageUpload">
        <section>
            <actions>
            </actions>
            <widgets>
                <decorator-screen name="main-decorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <!--<include-menu name="EcBackofficeTabBar" location="component://ecbackoffice/widget/EcBackofficeMenus.xml"/>-->
                        <platform-specific>
                            <html>
                                <html-template location="component://platformmanager/webapp/platformManager/template/uploadImg.ftl"></html-template>
                            </html>
                        </platform-specific>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>





    <!-- 产品内容 -->

    <screen name="RealProductImageAssoc">
        <section>
            <actions>
                <set field="headerItem" value="Buttons"/>
                <set field="tabButtonItem" value="RealProductImageAssoc" />
                <set field="productId" from-field="parameters.productId"/>
                <entity-one value-field="product" entity-name="Product"></entity-one>
                <!-- 载入所有颜色 -->
                <entity-condition entity-name="ProductDesignFeatureWithType" list="colorList" filter-by-date="true">
                    <condition-list>
                        <condition-expr field-name="productId" from-field="parameters.productId" operator="equals"/>
                        <condition-expr field-name="productFeatureTypeId" value="%COLOR" operator="like"/>
                    </condition-list>
                </entity-condition>

                <set field="variantProductId" value="${groovy:
					if(parameters.colorId==null)return parameters.productId;
					if(parameters.colorId!=null)return  main.java.com.banfftech.platformmanager.util.ZuczugProductUtils.checkProductMiddleSize(parameters.productId,parameters.colorId,delegator,dispatcher);
				}"/>

                <!-- 获取虚拟商品 4码的编号 -->
                <set field="variantProductId" value="${groovy:main.java.com.banfftech.platformmanager.util.ZuczugProductUtils.checkProductMiddleSize(parameters.productId,parameters.colorId,delegator,dispatcher)}"/>
                <!-- 获取单品图 -->
                <entity-condition entity-name="ProductContentAndInfo" list="singleProductImages">
                    <condition-list combine="and">
                        <condition-expr field-name="productId" from-field="variantProductId"/>
                        <condition-expr field-name="productContentTypeId" operator="equals" value="SINGLE_PRODUCT_IMAGE"/>
                    </condition-list>
                    <order-by field-name="sequenceNum"/>
                </entity-condition>

                <!-- 获取细节图 -->
                <entity-condition entity-name="ProductContentAndInfo" list="detailProductImages">
                    <condition-list combine="and">
                        <condition-expr field-name="productId" from-field="variantProductId"/>
                        <condition-expr field-name="productContentTypeId" operator="equals" value="DETAIL_PRODUCT_IMAGE"/>
                    </condition-list>
                    <order-by field-name="sequenceNum"/>
                </entity-condition>

                <!-- 获取包含这个商品的搭配Category -->
                <entity-and list="minmatchList" entity-name="ProductCategoryAndMember">
                    <field-map field-name="productId" from-field="variantProductId"/>
                    <field-map field-name="productCategoryTypeId" value="MIXMATCH_CATEGORY"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="RealProductImageManageCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-menu location="component://platformmanager/widget/platformmanagerMenus.xml" name="realProductImageTabBar"/>
                        <screenlet title="商品信息">
                            <include-form location="component://platformmanager/widget/PlatformManagerForms.xml" name="SelectColorToAssoc"/>
                        </screenlet>
                        <platform-specific>
                            <html>
                                <html-template location="component://platformmanager/webapp/platformManager/template/image/realProductImageAssoc.ftl" />
                            </html>
                        </platform-specific>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>








    <screen name="FindRealProductList">
        <section>
            <actions>
                <set field="headerItem" value="FindRealProductList"/>
                <set field="tabButtonItem" value="FindRealProductList" />
            </actions>
            <widgets>
                <decorator-screen name="main-decorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet title="${uiLabelMap.CommonSearch}">

                            <include-form name="FindProductVirtual" location="component://platformmanager/widget/PlatformManagerForms.xml" />
                        </screenlet>
                        <screenlet title="${uiLabelMap.CommonList}">
                            <include-form name="ProductVirtualList" location="component://platformmanager/widget/PlatformManagerForms.xml" />
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="FindRealProductContentList">
        <section>
            <actions>
                <set field="headerItem" value="main"/>
                <set field="tabButtonItem" value="FindRealProductContentList" />
            </actions>
            <widgets>
                <decorator-screen name="RealProductImageManageCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-menu location="component://platformmanager/widget/platformmanagerMenus.xml" name="mainSearchBar"/>
                        <screenlet title="${uiLabelMap.CommonSearch}">
                            <include-form name="FindProductVirtualContent" location="component://platformmanager/widget/PlatformManagerForms.xml" />
                        </screenlet>
                        <screenlet title="${uiLabelMap.CommonList}">
                            <include-form name="ProductVirtualContentList" location="component://platformmanager/widget/PlatformManagerForms.xml" />
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="FindRealProductContentListSimple">
        <section>
            <actions>
                <set field="headerItem" value="main"/>
                <set field="tabButtonItem" value="SimpleSearchProductContent" />
            </actions>
            <widgets>
                <decorator-screen name="RealProductImageManageCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-menu location="component://platformmanager/widget/platformmanagerMenus.xml" name="mainSearchBar"/>
                        <screenlet title="${uiLabelMap.CommonSearch}">
                            <include-form name="FindProductSimple" location="component://platformmanager/widget/PlatformManagerForms.xml" />
                        </screenlet>
                        <screenlet title="${uiLabelMap.CommonList}">
                            <include-form name="ListProductContentSimple" location="component://platformmanager/widget/PlatformManagerForms.xml" />
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>


    <screen name="RealProductImageAssoc">
        <section>
            <actions>
                <set field="headerItem" value="Buttons"/>
                <set field="tabButtonItem" value="RealProductImageAssoc" />
                <set field="productId" from-field="parameters.productId"/>
                <entity-one value-field="product" entity-name="Product"></entity-one>
                <!-- 载入所有颜色 -->
                <entity-condition entity-name="ProductDesignFeatureWithType" list="colorList" filter-by-date="true">
                    <condition-list>
                        <condition-expr field-name="productId" from-field="parameters.productId" operator="equals"/>
                        <condition-expr field-name="productFeatureTypeId" value="%COLOR" operator="like"/>
                    </condition-list>
                </entity-condition>

                <set field="variantProductId" value="${groovy:
					if(parameters.colorId==null)return parameters.productId;
					if(parameters.colorId!=null)return main.java.com.banfftech.platformmanager.util.ZuczugProductUtils.checkProductMiddleSize(parameters.productId,parameters.colorId,delegator,dispatcher);
				}"/>

                <!-- 获取虚拟商品 4码的编号 -->
                <set field="variantProductId" value="${groovy:main.java.com.banfftech.platformmanager.util.ZuczugProductUtils.checkProductMiddleSize(parameters.productId,parameters.colorId,delegator,dispatcher)}"/>
                <!-- 获取单品图 -->
                <entity-condition entity-name="ProductContentAndInfo" list="singleProductImages">
                    <condition-list combine="and">
                        <condition-expr field-name="productId" from-field="variantProductId"/>
                        <condition-expr field-name="productContentTypeId" operator="equals" value="SINGLE_PRODUCT_IMAGE"/>
                    </condition-list>
                    <order-by field-name="sequenceNum"/>
                </entity-condition>

                <!-- 获取细节图 -->
                <entity-condition entity-name="ProductContentAndInfo" list="detailProductImages">
                    <condition-list combine="and">
                        <condition-expr field-name="productId" from-field="variantProductId"/>
                        <condition-expr field-name="productContentTypeId" operator="equals" value="DETAIL_PRODUCT_IMAGE"/>
                    </condition-list>
                    <order-by field-name="sequenceNum"/>
                </entity-condition>

                <!-- 获取包含这个商品的搭配Category -->
                <entity-and list="minmatchList" entity-name="ProductCategoryAndMember">
                    <field-map field-name="productId" from-field="variantProductId"/>
                    <field-map field-name="productCategoryTypeId" value="MIXMATCH_CATEGORY"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="RealProductImageManageCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-menu location="component://platformmanager/widget/platformmanagerMenus.xml" name="realProductImageTabBar"/>
                        <screenlet title="商品信息">
                            <include-form location="component://platformmanager/widget/PlatformManagerForms.xml" name="SelectColorToAssoc"/>
                        </screenlet>
                        <platform-specific>
                            <html>
                                <html-template location="component://platformmanager/webapp/platformManager/template/image/realProductImageAssoc.ftl" />
                            </html>
                        </platform-specific>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>



    <screen name="LoadOSSResourceHtml">
        <section>
            <actions>
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://platformmanager/webapp/platformManager/template/image/OSSImageList.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <screen name="EditProductMatch">
        <section>
            <actions>
                <set field="headerItem" value="Buttons"/>
                <set field="tabButtonItem" value="EditProductMatch" />
                <set field="productId" from-field="parameters.productId"/>
                <entity-one value-field="product" entity-name="Product"></entity-one>

                <!-- 获取这个搭配的图片列表 -->
                <entity-and list="contents" entity-name="ProductCategoryContentAndInfo">
                    <field-map field-name="productCategoryId" from-field="parameters.productCategoryId"/>
                    <field-map field-name="prodCatContentTypeId" value="CATEGORY_IMAGE_URL"/>
                    <order-by field-name="sequenceNum"/>
                </entity-and>

                <!-- 获取商品列表 -->
                <entity-and list="memberList" entity-name="ProductCategoryMember">
                    <field-map field-name="productCategoryId" from-field="parameters.productCategoryId"/>
                    <order-by field-name="sequenceNum"/>
                </entity-and>

                <!-- 获取是否可以ipad用 -->
                <entity-one value-field="ipadUseAttribute" entity-name="ProductCategoryAttribute">
                    <field-map field-name="productCategoryId" from-field="parameters.productCategoryId"/>
                    <field-map field-name="attrName" value="ipadSeq"/>
                </entity-one>

                <!-- 获取是否可以网站用 -->
                <entity-one value-field="webSiteUseAttribute" entity-name="ProductCategoryAttribute">
                    <field-map field-name="productCategoryId" from-field="parameters.productCategoryId"/>
                    <field-map field-name="attrName" value="WEBSITE_USE"/>
                </entity-one>
            </actions>
            <widgets>
                <decorator-screen name="RealProductImageManageCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-menu location="component://platformmanager/widget/platformmanagerMenus.xml" name="realProductImageTabBar"/>
                        <platform-specific>
                            <html>
                                <html-template location="component://platformmanager/webapp/platformManager/template/image/editProductMatch.ftl" />
                            </html>
                        </platform-specific>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="realProductContent">
        <section>
            <actions>
                <set field="headerItem" value="Buttons"/>
                <set field="tabButtonItem" value="ProductContent" />
                <set field="productId" from-field="parameters.productId"/>
                <entity-and entity-name="ProductAssocViewWithVariant" list="productAssocList" filter-by-date="true">
                    <field-map field-name="productId" from-field="productId"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="RealProductImageManageCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <include-menu location="component://platformmanager/widget/platformmanagerMenus.xml" name="realProductImageTabBar"/>
                        <section>
                            <condition>
                                <if-empty field="productAssocList"/>
                            </condition>
                            <actions>
                                <set field="assoc.productIdTo" from-field="productId"/>
                                <set field="assoc.productId" from-field="productId"/>
                                <set field="productAssocList" type="Object"/>
                                <set field="productAssocList[]" from-field="assoc"/>
                            </actions>
                            <widgets>
                                <screenlet title="${uiLabelMap.CommonSearch}">
                                    <include-form name="realProductContent" location="component://platformmanager/widget/PlatformManagerForms.xml" />
                                </screenlet>
                            </widgets>
                            <fail-widgets>
                                <screenlet title="${uiLabelMap.CommonSearch}">
                                    <include-form name="realProductContent" location="component://platformmanager/widget/PlatformManagerForms.xml" />
                                </screenlet>
                            </fail-widgets>
                        </section>

                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="EditRealProductContent">
        <section>
            <actions>
                <set field="headerItem" value="EditRealProductContent"/>
                <set field="tabButtonItem" value="EditRealProductContent" />
                <entity-and entity-name="ProductAssocViewWithVariant" list="productAssocList" filter-by-date="true">
                    <field-map field-name="productId" from-field="parameters.productId"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="RealProductImageManageCommonDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet title="${uiLabelMap.CommonSearch}">
                            <include-form name="EditShopProductContent" location="component://platformmanager/widget/PlatformManagerForms.xml" />
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="realProductDescriptionExcelUpload">
        <section>
            <actions>
                <set field="headerItem" value="realProductDescriptionExcelUpload"/>
                <set field="tabButtonItem" value="realProductDescriptionExcelUpload" />
            </actions>
            <widgets>
                <decorator-screen name="main-decorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet title="导入商品描述">
                            <include-form name="realProductDescriptionUpload" location="component://platformmanager/widget/PlatformManagerForms.xml" />
                        </screenlet>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
</screens>